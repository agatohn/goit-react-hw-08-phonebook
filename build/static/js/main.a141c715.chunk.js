(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{104:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(25),o=n.n(a),u=n(14),s=n(7),i=n(3),l=n(16),d=n(44),b=n.n(d),j=n(34),f=n(6),O={key:"auth",storage:b.a,whitelist:["token"]},g=Object(i.a)({reducer:{auth:Object(l.g)(O,f.b),contacts:j.c},middleware:function(e){return e({serializableCheck:{ignoredActions:[l.a,l.f,l.b,l.c,l.d,l.e]}})},devTools:!1}),h=Object(l.h)(g),p=n(45),v=n(17),C=n(27),x=n(5),m=n(1),N=["children","restricted","redirectTo"];function k(e){var t=e.children,n=e.restricted,r=void 0!==n&&n,c=e.redirectTo,a=void 0===c?"/":c,o=Object(C.a)(e,N),u=Object(s.c)(f.c.getIsLoggedIn)&&r;return Object(m.jsx)(x.b,Object(v.a)(Object(v.a)({},o),{},{children:u?Object(m.jsx)(x.a,{to:a}):t}))}var y=["children","redirectTo"];function _(e){var t=e.children,n=e.redirectTo,r=void 0===n?"/":n,c=Object(C.a)(e,y),a=Object(s.c)(f.c.getIsLoggedIn);return Object(m.jsx)(x.b,Object(v.a)(Object(v.a)({},c),{},{children:a?t:Object(m.jsx)(x.a,{to:r})}))}var S=n(21),I=n.n(S),R=function(){return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(u.b,{className:I.a.nav,activeClassName:I.a.activeNav,to:"/register",exact:!0,children:"Sign Up"}),Object(m.jsx)(u.b,{className:I.a.nav,activeClassName:I.a.activeNav,to:"/login",exact:!0,children:"Login"})]})},E=n(22),L=n.n(E),w=function(){var e=Object(s.c)(f.c.getIsLoggedIn);return Object(m.jsxs)("nav",{children:[Object(m.jsx)(u.b,{className:L.a.nav,activeClassName:L.a.activeNav,to:"/",exact:!0,children:"Home"}),e&&Object(m.jsx)(u.b,{className:L.a.nav,activeClassName:L.a.activeNav,to:"/phonebook",exact:!0,children:"Phonebook"})]})},U=n(28),q=n.n(U),W=function(){var e=Object(s.b)(),t=Object(s.c)(f.c.getUserName);return Object(m.jsxs)("div",{className:q.a.userWrapper,children:[Object(m.jsxs)("span",{className:q.a.userName,children:["Log in as: ",t]}),Object(m.jsx)("button",{className:q.a.logBtn,type:"button",onClick:function(){e(f.a.logOut())},children:"logout"})]})},T=n(47),F=n.n(T);function z(){var e=Object(s.c)(f.c.getIsLoggedIn);return Object(m.jsxs)("header",{className:F.a.headerWrapper,children:[Object(m.jsx)(w,{})," ",e?Object(m.jsx)(W,{}):Object(m.jsx)(R,{})]})}var B=n(48),A=n.n(B),V=(n(103),Object(r.lazy)((function(){return n.e(6).then(n.bind(null,113))}))),M=Object(r.lazy)((function(){return n.e(5).then(n.bind(null,114))})),H=Object(r.lazy)((function(){return n.e(4).then(n.bind(null,115))})),J=Object(r.lazy)((function(){return n.e(3).then(n.bind(null,112))}));function P(){var e=Object(s.b)(),t=Object(s.c)(f.c.getIsRefreshingUser);return Object(r.useEffect)((function(){e(f.a.refreshCurrentUser())}),[e]),!t&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(z,{}),Object(m.jsx)(x.d,{children:Object(m.jsxs)(r.Suspense,{fallback:Object(m.jsx)("div",{children:Object(m.jsx)(A.a,{className:"Loader",type:"ThreeDots",color:"#00BFFF",height:20,width:100,timeout:3e3})}),children:[Object(m.jsx)(k,{exact:!0,path:"/",children:Object(m.jsx)(V,{})}),Object(m.jsx)(k,{path:"/register",restricted:!0,children:Object(m.jsx)(M,{})}),Object(m.jsx)(k,{path:"/login",restricted:!0,redirectTo:"/phonebook",children:Object(m.jsx)(H,{})}),Object(m.jsx)(_,{path:"/phonebook",restricted:!0,redirectTo:"/login",children:Object(m.jsx)(J,{})})]})})]})}o.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(s.a,{store:g,children:Object(m.jsx)(p.a,{loading:null,persistor:h,children:Object(m.jsx)(u.a,{children:Object(m.jsx)(P,{})})})})}),document.getElementById("root"))},21:function(e,t,n){e.exports={nav:"AuthNavigation_nav__PXa_x",activeNav:"AuthNavigation_activeNav__2h5av"}},22:function(e,t,n){e.exports={nav:"Navigation_nav__1XtRS",activeNav:"Navigation_activeNav__2Y6gK"}},28:function(e,t,n){e.exports={userWrapper:"Menu_userWrapper__2T7kl",userName:"Menu_userName__CEOEd",logBtn:"Menu_logBtn__1x3ZW"}},34:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return b})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return k}));var r,c,a,o=n(3),u={getContactsRequest:Object(o.b)("contacts/getContactsRequest"),getContactsSuccess:Object(o.b)("contacts/getContactsSuccess"),getContactsError:Object(o.b)("contacts/getContactsError"),addContactRequest:Object(o.b)("contacts/addContactRequest"),addContactSuccess:Object(o.b)("contacts/addContactSuccess"),addContactError:Object(o.b)("contacts/addContactError"),deleteContactRequest:Object(o.b)("contacts/deleteContactRequest"),deleteContactSuccess:Object(o.b)("contacts/deleteContactSuccess"),deleteContactError:Object(o.b)("contacts/deleteContactError"),changeFilter:Object(o.b)("contacts/filter")},s=n(26),i=function(e){return e.contacts.contacts},l=function(e){return e.contacts.filter},d=Object(s.a)([i,l],(function(e,t){var n=t.toLowerCase();return e.filter((function(e){return e.name.toLowerCase().includes(n)}))})),b={getContacts:i,getFilter:l,getVisibleContacts:d},j=n(13),f=n.n(j),O={getContact:function(){return function(e){e(u.getContactsRequest()),f.a.get("/contacts").then((function(t){var n=t.data;return e(u.getContactsSuccess(n))})).catch((function(t){return e(u.getContactsError(t))}))}},addContact:function(e){var t=e.name,n=e.number;return function(e,r){var c={name:t,number:n},a=r().contacts.contacts;if(null===a||void 0===a?void 0:a.some((function(e){return e.name.toLocaleLowerCase()===t.toLocaleLowerCase()||a.some((function(e){return e.number===n}))})))return e(u.addContactError("Name: ".concat(t," or number: ").concat(n," is alredy exist")));e(u.addContactRequest()),f.a.post("/contacts",c).then((function(t){var n=t.data;return e(u.addContactSuccess(n))})).catch((function(t){return e(u.addContactError(t))}))}},deleteContact:function(e){return function(t){t(u.deleteContactRequest()),f.a.delete("/contacts/".concat(e)).then((function(){return t(u.deleteContactSuccess(e))})).catch((function(e){return t(u.deleteContactError(e))}))}}},g=n(2),h=n(49),p=n(8),v=n(6),C=Object(o.d)([],(r={},Object(g.a)(r,u.getContactsSuccess,(function(e,t){return t.payload})),Object(g.a)(r,u.addContactSuccess,(function(e,t){var n=t.payload;return[].concat(Object(h.a)(e),[n])})),Object(g.a)(r,u.addContactError,(function(e,t){var n=t.payload;return alert(n)})),Object(g.a)(r,u.deleteContactSuccess,(function(e,t){var n=t.payload;return e.filter((function(e){return e.id!==n}))})),Object(g.a)(r,v.a.logOut.fulfilled,(function(){return[]})),r)),x=Object(o.d)("",Object(g.a)({},u.changeFilter,(function(e,t){return t.payload}))),m=Object(o.d)(!1,(c={},Object(g.a)(c,u.getContactsRequest,(function(){return!0})),Object(g.a)(c,u.getContactsSuccess,(function(){return!1})),Object(g.a)(c,u.getContactsError,(function(){return!1})),Object(g.a)(c,u.addContactRequest,(function(){return!0})),Object(g.a)(c,u.addContactSuccess,(function(){return!1})),Object(g.a)(c,u.addContactError,(function(){return!1})),Object(g.a)(c,u.deleteContactRequest,(function(){return!0})),Object(g.a)(c,u.deleteContactSuccess,(function(){return!1})),Object(g.a)(c,u.deleteContactError,(function(){return!1})),c)),N=Object(o.d)(null,(a={},Object(g.a)(a,u.getContactsError,(function(e,t){return t.payload})),Object(g.a)(a,u.addContactError,(function(e,t){return t.payload})),Object(g.a)(a,u.deleteContactError,(function(e,t){return t.payload})),Object(g.a)(a,u.getContactsSuccess,(function(){return null})),Object(g.a)(a,u.addContactSuccess,(function(){return null})),Object(g.a)(a,u.deleteContactSuccess,(function(){return null})),a)),k=Object(p.b)({contacts:C,filter:x,loading:m,error:N})},47:function(e,t,n){e.exports={headerWrapper:"Header_headerWrapper__2b9Wd"}},6:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return h}));var r=n(2),c=n(3),a=n(15),o=n.n(a),u=n(20),s=n(13),i=n.n(s);i.a.defaults.baseURL="https://connections-api.herokuapp.com";var l,d=function(e){i.a.defaults.headers.common.Authorization="Bearer ".concat(e)},b=function(){i.a.defaults.headers.common.Authorization=""},j=Object(c.c)("auth/register",function(){var e=Object(u.a)(o.a.mark((function e(t,n){var r,c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,i.a.post("/users/signup",t);case 4:return c=e.sent,a=c.data,d(a.token),e.abrupt("return",a);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",r(e.t0.message));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()),f=Object(c.c)("auth/login",function(){var e=Object(u.a)(o.a.mark((function e(t,n){var r,c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,i.a.post("/users/login",t);case 4:return c=e.sent,a=c.data,d(a.token),e.abrupt("return",a);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",r(e.t0.message));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()),O=Object(c.c)("auth/logout",function(){var e=Object(u.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,i.a.post("/users/logout");case 4:b(),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",r(e.t0.message));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}()),g=Object(c.c)("auth/refresh",function(){var e=Object(u.a)(o.a.mark((function e(t,n){var r,c,a,u,s,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rejectWithValue,c=n.getState,a=c(),null!==(u=a.auth.token)){e.next=5;break}return e.abrupt("return",r());case 5:return d(u),e.prev=6,e.next=9,i.a.get("/users/current");case 9:return s=e.sent,l=s.data,e.abrupt("return",l);case 14:return e.prev=14,e.t0=e.catch(6),e.abrupt("return",r(e.t0.message));case 17:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t,n){return e.apply(this,arguments)}}()),h={register:j,logOut:O,logIn:f,refreshCurrentUser:g},p=Object(c.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1,isRefreshingUser:!1,error:null},extraReducers:(l={},Object(r.a)(l,h.register.pending,(function(e){e.error=null})),Object(r.a)(l,h.register.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0})),Object(r.a)(l,h.register.rejected,(function(e,t){e.error=t.payload})),Object(r.a)(l,h.logIn.pending,(function(e){e.error=null})),Object(r.a)(l,h.logIn.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0})),Object(r.a)(l,h.logIn.rejected,(function(e,t){e.error=t.payload})),Object(r.a)(l,h.logOut.pending,(function(e){e.error=null})),Object(r.a)(l,h.logOut.fulfilled,(function(e){e.user={name:null,email:null},e.token=null,e.isLoggedIn=!1,e.isRefreshingUser=!1})),Object(r.a)(l,h.logOut.rejected,(function(e,t){e.error=t.payload})),Object(r.a)(l,h.refreshCurrentUser.pending,(function(e){e.isRefreshingUser=!0})),Object(r.a)(l,h.refreshCurrentUser.fulfilled,(function(e,t){e.user=t.payload,e.isLoggedIn=!0,e.isRefreshingUser=!1})),Object(r.a)(l,h.refreshCurrentUser.rejected,(function(e){e.isRefreshingUser=!1})),l)}).reducer,v={getIsLoggedIn:function(e){return e.auth.isLoggedIn},getUserName:function(e){return e.auth.user.name},getIsRefreshingUser:function(e){return e.auth.isRefreshingUser}}}},[[104,1,2]]]);
//# sourceMappingURL=main.a141c715.chunk.js.map